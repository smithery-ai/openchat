{
	"$schema": "https://ui.shadcn.com/schema/registry-item.json",
	"name": "smithery-tokens",
	"title": "Smithery Tokens",
	"description": "A component for managing Smithery API tokens with selection and creation capabilities.",
	"dependencies": ["@smithery/api", "jotai", "lucide-react"],
	"registryDependencies": ["button", "dialog", "select"],
	"files": [
		{
			"path": "registry/new-york/smithery/tokens.tsx",
			"content": "\"use client\";\n\nimport type { CreateTokenResponse } from \"@smithery/api/resources/tokens.mjs\";\nimport { atom, useAtom } from \"jotai\";\nimport { atomWithStorage } from \"jotai/utils\";\nimport { Trash2 } from \"lucide-react\";\nimport { useEffect, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n\tDialog,\n\tDialogContent,\n\tDialogHeader,\n\tDialogTitle,\n\tDialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n\tSelect,\n\tSelectContent,\n\tSelectItem,\n\tSelectTrigger,\n\tSelectValue,\n} from \"@/components/ui/select\";\n\n// Jotai atoms for token state management\nexport const tokensCreatedAtom = atomWithStorage<CreateTokenResponse[]>(\n\t\"tokensCreated\",\n\t[],\n);\nexport const selectedTokenAtom = atom<CreateTokenResponse | null>(null);\n\nexport function Tokens({\n\tinitialTokenResponse,\n\tonCreateToken,\n}: {\n\tinitialTokenResponse: CreateTokenResponse;\n\tonCreateToken?: () => Promise<CreateTokenResponse>;\n}) {\n\tconst [tokensCreated, setTokensCreated] = useAtom(tokensCreatedAtom);\n\tconst [selectedToken, setSelectedToken] = useAtom(selectedTokenAtom);\n\tconst [isOpen, setIsOpen] = useState(false);\n\n\tuseEffect(() => {\n\t\tsetTokensCreated((prev) => {\n\t\t\t// Only add if it doesn't already exist\n\t\t\tif (prev.some((token) => token.token === initialTokenResponse.token)) {\n\t\t\t\treturn prev;\n\t\t\t}\n\t\t\treturn [...prev, initialTokenResponse];\n\t\t});\n\t}, [initialTokenResponse, setTokensCreated]);\n\n\tuseEffect(() => {\n\t\tif (!selectedToken && tokensCreated.length > 0) {\n\t\t\tsetSelectedToken(tokensCreated[0]);\n\t\t}\n\t}, [selectedToken, setSelectedToken, tokensCreated]);\n\n\tconst handleRemoveToken = () => {\n\t\tif (!selectedToken) return;\n\n\t\tsetTokensCreated((prev) =>\n\t\t\tprev.filter((token) => token.token !== selectedToken.token),\n\t\t);\n\t\tsetSelectedToken(null);\n\t};\n\n\tif (!selectedToken) return null;\n\n\treturn (\n\t\t<div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n\t\t\t<span>\n\t\t\t\tUsing token:{\" \"}\n\t\t\t\t{selectedToken.token.startsWith(\"v4.public\")\n\t\t\t\t\t? \"Service Token\"\n\t\t\t\t\t: \"Root API Key\"}{\" \"}\n\t\t\t\t*****{selectedToken.token.slice(-4)}\n\t\t\t</span>\n\t\t\t<Dialog open={isOpen} onOpenChange={setIsOpen}>\n\t\t\t\t<DialogTrigger asChild>\n\t\t\t\t\t<Button variant=\"outline\" size=\"sm\">\n\t\t\t\t\t\tModify\n\t\t\t\t\t</Button>\n\t\t\t\t</DialogTrigger>\n\t\t\t\t<DialogContent>\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>Manage Tokens</DialogTitle>\n\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t{tokensCreated.length > 1 && (\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<div className=\"text-sm font-medium\">Select Token</div>\n\t\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\t\tvalue={selectedToken.token}\n\t\t\t\t\t\t\t\t\tonValueChange={(tokenValue) => {\n\t\t\t\t\t\t\t\t\t\tconst token = tokensCreated.find(\n\t\t\t\t\t\t\t\t\t\t\t(t) => t.token === tokenValue,\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tif (token) setSelectedToken(token);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<SelectTrigger className=\"w-full\">\n\t\t\t\t\t\t\t\t\t\t<SelectValue />\n\t\t\t\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t\t\t\t{tokensCreated.map((token) => (\n\t\t\t\t\t\t\t\t\t\t\t<SelectItem key={token.token} value={token.token}>\n\t\t\t\t\t\t\t\t\t\t\t\t{token.token.startsWith(\"v4.public\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t? \"Service Token\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t: \"Root API Key\"}\n\t\t\t\t\t\t\t\t\t\t\t\t: *****{token.token.slice(-4)}\n\t\t\t\t\t\t\t\t\t\t\t</SelectItem>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t\t\t\t</Select>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t<div className=\"rounded-lg border p-4 space-y-2\">\n\t\t\t\t\t\t\t<div className=\"flex items-start justify-between\">\n\t\t\t\t\t\t\t\t<div className=\"space-y-1\">\n\t\t\t\t\t\t\t\t\t<div className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t{selectedToken.token.startsWith(\"v4.public\")\n\t\t\t\t\t\t\t\t\t\t\t? \"Service Token\"\n\t\t\t\t\t\t\t\t\t\t\t: \"Root API Key\"}\n\t\t\t\t\t\t\t\t\t\t: *****{selectedToken.token.slice(-4)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t{selectedToken.expiresAt !== \"never\" && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\tExpires:{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t{new Date(selectedToken.expiresAt).toLocaleString()}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{tokensCreated.length > 1 &&\n\t\t\t\t\t\t\t\t\tselectedToken.expiresAt !== \"never\" && (\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"icon-sm\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={handleRemoveToken}\n\t\t\t\t\t\t\t\t\t\t\taria-label=\"Remove token\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Trash2 className=\"size-4\" />\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"flex  gap-2\">\n\t\t\t\t\t\t\t{onCreateToken && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tonCreateToken().then((tokenResponse) => {\n\t\t\t\t\t\t\t\t\t\t\tsetTokensCreated([...tokensCreated, tokenResponse]);\n\t\t\t\t\t\t\t\t\t\t\tsetSelectedToken(tokenResponse);\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tCreate New Token\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<Button onClick={() => setIsOpen(false)} className=\"flex-1\">\n\t\t\t\t\t\t\t\tDone\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\t\t</div>\n\t);\n}\n",
			"type": "registry:component",
			"target": "components/smithery/tokens.tsx"
		}
	],
	"type": "registry:block"
}
